#Importing Public vs Private Enrollment County dataset

```{r install_tidyverse}
install.packages('tidyverse')
library(tidyverse)
```
 
```{r importing_csv}

library(readr)
Enrollment_dataset <- read_csv("dataset/public-vs-private-enrollment-county-2019.csv") 


```

```{r importing_xl}
library(readxl)
Unemployment_dataset <- read_excel("dataset/Unemployment.xlsx", range = "A5:CN3201")
Education_dataset <- read_excel("dataset/Education.xlsx", range = "A5:AU3209")
```

#Sorting it out using data summary techniques

```{r reactable_code}

library(reactable)
reactable(Enrollment_dataset, sortable = FALSE, showPageSizeOptions = TRUE, 
    onClick = "expand")
reactable(Unemployment_dataset, sortable = FALSE, showPageSizeOptions = TRUE, 
    onClick = "expand")
```
#Making the change for you

```{r income_tbl}
income_table <- Unemployment_dataset %>%
  select("FIPS_Code","Area_name","Median_Household_Income_2019")
```

```{r edu_tbl}
edu_table <- Education_dataset %>%
  select(c(1),c(3),c(44:47))%>%
  rename("FIPS_Code" = "FIPS Code")%>%
  rename("Percent_Bachelors" = c(6))
```

```{r}
inc_edu_state <- merge(x = income_table, y = edu_table, by = "FIPS_Code")%>%
  select(-c(4))%>%
  filter(endsWith(FIPS_Code,"000"))

inc_edu_county <- merge(x = income_table, y = edu_table, by = "FIPS_Code")%>%
  select(-c(4))%>%
  filter(!endsWith(FIPS_Code,"000"))
```

Graphs and Linear Models:

```{r income_edu_lin_model}
ggplot(inc_edu_county,aes(Median_Household_Income_2019,Percent_Bachelors))+
  geom_point()

income_model <- lm(Median_Household_Income_2019~Percent_Bachelors,data=inc_edu_county)
summary(income_model)
```


```{r Comparing percentages (Magesh)}

plot(inc_edu_county[, 3:7], main = "Correlation plot")

par(mfrow = c(1, 1))

```





```{r State_Map Magesh}
library(usmap)

US_State <- map_data('state')

ggplot(data=US_State, aes(x=long, y=lat, fill=region, group=group)) +
  geom_polygon(color = "Black") +
  guides(fill = FALSE)

```


```{r County_Map Magesh}
library(usmap)

US_county <- map_data('county')

ggplot(data=US_county, aes(x=long, y=lat, fill=region, group=group)) +
  geom_polygon(color = "Black") +
  guides(fill = FALSE)

```

```{r Statewise Cleaning}


library (usmap)
St_Pop <- inc_edu_state[order(inc_edu_state$Area_name),]
St_Pop <- St_Pop[!(St_Pop$Area_name == "United States"),]
St_Pop$fips <- statepop$fips
St_Pop$abbr <- statepop$abbr

St_Pop <- St_Pop %>% 
  rename(Income = Median_Household_Income_2019) %>% 
  rename(Less_than_High_School = `Percent of adults with less than a high school diploma, 2015-19`) %>% 
  rename ( High_School_Only = `Percent of adults with a high school diploma only, 2015-19`) %>% 
  rename(College_or_Associate = `Percent of adults completing some college or associate's degree, 2015-19`) %>% 
  rename(Bachelors = Percent_Bachelors)

```

```{r Statewise Income}

plot_usmap(data = St_Pop,
           values = "Income",
           labels = TRUE) +
  scale_fill_gradient(low = "red",
                      high = 'green',
                      name = NULL) +
  ggtitle("Statewise Median Income (US,2019)") +
  theme(plot.title = element_text(size = 15,
                                  hjust = 0.5)) +
  theme(legend.position = c(0.2,-0.1),
        legend.direction = 'horizontal',
        legend.key.width = unit(0.8,"in"),
        legend.key.height = unit(0.2,"in"),
        legend.text = element_text(size = 15))

```

```{r Statewise Less than high school}

plot_usmap(data = St_Pop,
           values = "Less_than_High_School",
           labels = TRUE) +
  scale_fill_gradient(low = "red",
                      high = 'green',
                      name = NULL) +
  ggtitle("Statewise Less than High School") +
  theme(plot.title = element_text(size = 15,
                                  hjust = 0.5)) +
  theme(legend.position = c(0.2,-0.1),
        legend.direction = 'horizontal',
        legend.key.width = unit(0.8,"in"),
        legend.key.height = unit(0.2,"in"),
        legend.text = element_text(size = 15))


```

```{r Statewise High School Only}

plot_usmap(data = St_Pop,
           values = "High_School_Only",
           labels = TRUE) +
  scale_fill_gradient(low = "red",
                      high = 'green',
                      name = NULL) +
  ggtitle("Statewise High School Only") +
  theme(plot.title = element_text(size = 15,
                                  hjust = 0.5)) +
  theme(legend.position = c(0.2,-0.1),
        legend.direction = 'horizontal',
        legend.key.width = unit(0.8,"in"),
        legend.key.height = unit(0.2,"in"),
        legend.text = element_text(size = 15))